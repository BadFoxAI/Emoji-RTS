<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji RTS - Modular v2</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="rtsmenu-dark-theme"> <!-- Defaulting to dark theme for the game -->

    <!-- Start Modal: Player Chooses Faction or Mode -->
    <div id="start-modal-overlay">
        <div id="start-modal">
            <h2>Choose your Faction:</h2>
            <div>
                <button id="human-btn">üè∞ Humans</button>
                <button id="versus-btn">ü§ñ AI vs AI ü§ñ</button>
                <button id="zombie-btn">üèØ Zombies</button>
            </div>
            <p class="error-message" style="color:red; min-height: 1em;"></p> <!-- For init errors -->
        </div>
    </div>

    <!-- Main Menu Modal: Accessed during gameplay (e.g., via Escape) -->
    <div id="main-menu-overlay">
        <div id="main-menu-modal">
            <h2>Main Menu</h2>
            <button id="resume-game-btn">Resume Game</button>
            <button id="editor-mode-btn">Map Editor (Conceptual)</button>
            <button id="restart-game-btn">Restart Game (New Faction)</button>
        </div>
    </div>

    <!-- Main Game Viewport -->
    <div id="viewport">
        <div id="game-world">
            <!-- Game objects (units, buildings, resources) will be appended here by JavaScript -->
        </div>
    </div>

    <!-- UI Panel: Displays resources, selection info, and command card -->
    <div id="ui-panel">
        <div id="ui-left-elements">
            <div id="resource-display">
                Wood: <span id="wood-count">0</span>
                Coal: <span id="coal-count">0</span>
                Food: <span id="food-count">0</span>/<span id="food-capacity">4</span>
            </div>
            <div id="selection-info">Selected: None</div>
        </div>
        <div id="command-card-container">
            <!-- JSRTSMenu for the command card will be dynamically rendered here -->
        </div>
    </div>
    
    <!-- Debug Panel: Toggled with backtick (`) -->
    <div id="debug-panel">
        <div>[DEBUG `]</div><hr>
        <div>Game State: <span id="debug-current-game-state">N/A</span></div>
        <div>Player Faction: <span id="debug-player-faction">N/A</span></div>
        <div>Opponent Faction: <span id="debug-opponent-faction">N/A</span></div>
        <div>World: <span id="debug-world-size">N/A</span></div>
        <div>Total Units: <span id="debug-unit-count">0</span></div>
        <hr>
        <div>P1 Res: W<span id="debug-p1-wood">0</span> C<span id="debug-p1-coal">0</span> F<span id="debug-p1-food">0</span>/<span id="debug-p1-food-cap">0</span></div>
        <div>P2 Res: W<span id="debug-p2-wood">0</span> C<span id="debug-p2-coal">0</span> F<span id="debug-p2-food">0</span>/<span id="debug-p2-food-cap">0</span></div>
        <hr>
        <div>Sel ID: <span id="debug-selected-id">N/A</span></div>
        <div>Sel Type: <span id="debug-selected-type">N/A</span></div>
        <div>Sel Faction: <span id="debug-selected-faction-sel">N/A</span></div>
        <div>Sel HP: <span id="debug-selected-hp">N/A</span></div>
        <div>Sel State: <span id="debug-selected-state">N/A</span></div>
        <div>Sel Target: <span id="debug-selected-target">N/A</span></div>
        <hr>
        <div>P1 Buildings: <span id="debug-p1-building-count">0</span> P2 Buildings: <span id="debug-p2-building-count">0</span></div>
        <div>Constructions: <span id="debug-construction-count">0</span></div>
        <div>Resource Nodes: <span id="debug-resource-nodes-count">N/A</span></div>
   </div>

    <!-- Game Over Message -->
    <div id="game-over-message"></div>

    <!-- JSRTSMenu requires these for its popups. They are styled to be hidden until used. -->
    <div id="context-menu-actual-container" class="js-rts-menu-base-container" role="menu" aria-orientation="vertical"></div>
    <div id="command-card-menu-actual-container" class="js-rts-menu-base-container" role="menu" aria-orientation="vertical"></div>
    <div id="js-rts-menu-global-tooltip" role="tooltip" aria-hidden="true"></div>

    <!-- Scripts: Load in order of dependency -->
    <script src="js/menu-component/rts-menu.js"></script>
    <!-- <script src="js/menu-component/menu-icons.js"></script> If you split icons out -->

    <script src="js/game-config/constants.js"></script>
    <script src="js/game-config/faction-data.js"></script>

    <script src="js/game-core/game-state.js"></script> 
    <script src="js/ui-and-input/ui-helpers.js"></script> <!-- UI Helpers might be needed by entity manager for DOM creation -->
    <script src="js/game-core/entity-manager.js"></script>
    <script src="js/game-core/game-rules.js"></script>
    <script src="js/game-core/resource-logic.js"></script>
    <script src="js/game-core/construction-logic.js"></script>
    <script src="js/game-core/ai-logic.js"></script>
    <script src="js/game-core/game-loop.js"></script>

    <script src="js/ui-and-input/ui-dom-elements.js"></script> 
    <script src="js/ui-and-input/ui-updates.js"></script>
    <script src="js/ui-and-input/ui-menu-builders.js"></script>
    <script src="js/ui-and-input/camera.js"></script>
    <script src="js/ui-and-input/placement.js"></script>
    <script src="js/ui-and-input/input-handler.js"></script>

    <script src="js/main.js"></script> 
</body>
</html>
